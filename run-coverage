#!/bin/bash
set -e

echo "ğŸ§¹ Cleaning up previous results..."
find . -type d -name "TestResults" -exec rm -rf {} +
rm -rf coveragereport

echo "ğŸ§ª Running tests with code coverage..."
dotnet test --coverage --coverage-output-format cobertura

echo "ğŸ“Š Generating coverage report..."
reportgenerator -reports:"**/TestResults/*cobertura.xml" -targetdir:"coveragereport" -reporttypes:"Html;TextSummary"

echo "ğŸ“– Opening report..."
open coveragereport/index.html

echo "ğŸ“ Summary:"
cat coveragereport/Summary.txt

echo "âœ… Done!"
